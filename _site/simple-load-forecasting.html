<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Forecast hourly load - ⚡️ Load forecasting and peak shaving with neural networks</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>Forecast hourly load | ⚡️ Load forecasting and peak shaving with neural networks</title> <meta name="generator" content="Jekyll v4.2.0" /> <meta property="og:title" content="Forecast hourly load" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Increasing the accuracy of day-ahead load forecasting can save utilities tens of thousands of dollars. Neural networks and other statistical techniques can help." /> <meta property="og:description" content="Increasing the accuracy of day-ahead load forecasting can save utilities tens of thousands of dollars. Neural networks and other statistical techniques can help." /> <meta property="og:site_name" content="⚡️ Load forecasting and peak shaving with neural networks" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Forecast hourly load" /> <script type="application/ld+json"> {"description":"Increasing the accuracy of day-ahead load forecasting can save utilities tens of thousands of dollars. Neural networks and other statistical techniques can help.","@type":"WebPage","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"/img/logo.png"}},"url":"/simple-load-forecasting","headline":"Forecast hourly load","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="/" class="site-title lh-tight"> <div class="site-logo"></div> </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-list-link">⚡️ Load forecasting and peak shaving with neural networks</a></li><li class="nav-list-item active"><a href="/simple-load-forecasting" class="nav-list-link active">Forecast hourly load</a></li><li class="nav-list-item"><a href="/day-long-load-forecasting" class="nav-list-link">Forecast day-long load</a></li><li class="nav-list-item"><a href="/predict-monthly-peak" class="nav-list-link">Predict monthly peak</a></li><li class="nav-list-item"><a href="/calculate-uncertainty" class="nav-list-link">Calculate uncertainty</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search ⚡️ Load forecasting and peak shaving with neural networks" aria-label="Search ⚡️ Load forecasting and peak shaving with neural networks" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <div id="main-content" class="main-content" role="main"> <p><img src="../img/headers/simple-load-forecasting.png" alt="header" /></p> <h1 id="using-neural-nets-to-predict-tomorrows-electric-consumption"> <a href="#using-neural-nets-to-predict-tomorrows-electric-consumption" class="anchor-heading" aria-labelledby="using-neural-nets-to-predict-tomorrows-electric-consumption"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Using neural nets to predict tomorrow’s electric consumption </h1> <h2 id="the-smallest-error-can-lose-utilities-thousands-of-dollars-in-a-single-day-neural-networks-can-help-make-sure-that-doesnt-happen"> <a href="#the-smallest-error-can-lose-utilities-thousands-of-dollars-in-a-single-day-neural-networks-can-help-make-sure-that-doesnt-happen" class="anchor-heading" aria-labelledby="the-smallest-error-can-lose-utilities-thousands-of-dollars-in-a-single-day-neural-networks-can-help-make-sure-that-doesnt-happen"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> The smallest error can lose utilities thousands of dollars in a single day. Neural networks can help make sure that doesn’t happen. </h2> <p><em>March 7, 2019</em></p> <p>Electricity distributors stand to save hundreds of thousands of dollars by decreasing their peak demand charge. Some have tried to discharge batteries or turn off customers’ water heaters or air conditioners at peak hours to reduce their demand. But these efforts are only as effective as the utility’s ability to predict the day’s energy consumption.</p> <p>The smallest inaccuracy can mean the difference between tens of thousands of dollars—implementing a peak-shaving strategy with incorrect load predictions can even increase demand cost. Thankfully, advances in deep learning and neural networks can offer utilities an incredibly accurate picture of the next day’s energy consumption. The Open Modeling Framework (OMF) and I have used neural networks to create a day-ahead load forecasting model that can be easily implemented to inform dispatch decisions.</p> <h3 id="why-not-something-simpler"> <a href="#why-not-something-simpler" class="anchor-heading" aria-labelledby="why-not-something-simpler"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Why not something simpler? </h3> <p>We initially created a linear regression model with the python package sci-kit learn. Although this simpler model achieved 10 mean absolute percent error (MAPE), it was not accurate enough to reduce peaks reliably.</p> <p>The biggest obstacle was the difference in daily peaks between winter and summer months. Winter months peaked twice a day and summer months peaked in the middle of the day. A linear model cannot create these two daily load shapes at the same time. While linear regression can find simple relationships (+500kW because it’s Monday, -100kW because it’s March), a neural network can calculate more complicated relationships (+5100kW because it’s 3pm on a Monday in April, -1500kW because it’s 5am on Thanksgiving). This reduced our training error to roughly 3.5 MAPE, which translated to tens of thousands of dollars saved.</p> <p><img src="../img/std_pred_1.png" alt="" /></p> <h3 id="software-details"> <a href="#software-details" class="anchor-heading" aria-labelledby="software-details"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Software Details </h3> <p>In order to incorporate the load forecast software into the OMF database, our model is written in Python. We use the pandas package to manipulate data, and we have implemented Tensorflow’s Keras (Google’s machine learning software) to create a neural network. ###Here is a link### to the repository. The code is easy to use:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">loadForecast</span> <span class="k">as</span> <span class="n">fc</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">"test.csv"</span><span class="p">)</span>
<span class="n">all_X</span> <span class="o">=</span> <span class="n">fc</span><span class="p">.</span><span class="n">makeUsefulDf</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">all_y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">"load"</span><span class="p">]</span>
<span class="n">predictions</span><span class="p">,</span> <span class="n">accuracy</span> <span class="o">=</span> <span class="n">fc</span><span class="p">.</span><span class="n">neural_net_predictions</span><span class="p">(</span><span class="n">all_X</span><span class="p">,</span> <span class="n">all_y</span><span class="p">)</span>
</code></pre></div></div> <p>For our initial testing purposes, <code class="language-plaintext highlighter-rouge">neural_net_predictions</code> simply returns the predictions for the final year; however, it can be quickly updated to work for a utility in real-time.</p> <h3 id="structure"> <a href="#structure" class="anchor-heading" aria-labelledby="structure"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Structure </h3> <p>The structure of the neural network is continually being updated as we search for more accurate and efficient methods; however, we have currently settled on a five-layer, fully-connected network where each layer contains 71 nodes. We use a ReLU function in each layer and are minimizing mean squared error.</p> <h3 id="inputs"> <a href="#inputs" class="anchor-heading" aria-labelledby="inputs"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Inputs </h3> <p>We recommend that the model train on at least three years of data. The model takes a CSV as input, where each row lists the load and weather for a given year, month, day, and hour. If a utility doesn’t have temperature data available, OMF also offers “weatherPull,” a program that can easily collect and return hourly weather for a given zip code. If there are any null temperature values, the load forecast function uses the “forward fill” method, where null values are replaced by the last non-null value. For example, “38, 39, 41, NaN, NaN, 38, NaN, 32” would be read as “38, 39, 41, 41, 41, 38, 38, 32.” Features</p> <p>Although each training example contains the date, temperature, and weather data, we expand these three columns into 72 features that are useful for a machine learning model. Here is a list of all features:</p> <ul> <li>Years since 2000*</li> <li>Load from 24 hours before*</li> <li>Hour of day (is12AM, is1AM, … is 11PM)</li> <li>Day of the week (isSunday, isMonday, … isSaturday)</li> <li>Month of the year (isJanuary, isFebruary, … is December)</li> <li>Temperature* **</li> <li>Temperature² ***</li> <li>Previous day’s load* (12AM of day previous, 1AM of day previous, … 11PM of day previous)</li> <li>Holidays (the NERC6 holidays)<em>**</em> (isNewYears, isMemorialDay…isChristmas)</li> </ul> <p>*These features are normalized by subtracting from the mean and dividing by the standard deviation, which helps collect all data points closely around zero. By dividing by the standard deviation instead of the range (as some data scientists suggest), we improved accuracy by one percent.</p> <p>**The National Weather Service estimates that their day-ahead hourly weather forecast is often within 2.5 degrees. To replicate this, we create noise in the training and test temperature data by adding a gaussian distribution centered at zero with the standard deviation of 2.5. When this noise was added, the accuracy of the model dropped by one percent.</p> <p>***If you graph load against temperature, you’ll see that load is proportional to temperature²—heaters are used in the coldest temperatures and air conditioners in the hottest temperatures. By adding a temperature² feature, we can make this relationship more obvious to the model.</p> <p>****Observed holidays are also “1” (or “True”). For example, Independence Day 2015 was on a Saturday, so it was observed on Friday, July 3. Both July 3 and July 4 for 2015 are marked as “1” for the “isIndependenceDay” feature.</p> <h3 id="results"> <a href="#results" class="anchor-heading" aria-labelledby="results"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Results </h3> <p>We trained this neural net on ERCOT’s Houston data from 2002–2017 and tested the model against the load for 2018. We achieved roughly 96.5 percent accuracy (3.5 MAPE). The entire program often runs within 10 minutes. We deployed this neural net on a demand reduction model with a utility using batteries to shift load to reduce demand and found that we saved 40 percent of the optimal solution (e.g. if everything ran perfectly, the utility would save $95,000 on demand charge, but because forecasting isn’t perfect, it saved approximately $40,000. This assumes the typical $20/kW demand charge. Demand charge, among other values, is an input to our cost-benefit model, and we’re in process of extending these results to other utilities.)</p> <p>There are more complicated machine learning structures that we are currently pursuing, given that the smallest improvements can have such a profound effect on a utility’s bottom line.</p> <p>Also, it costs money to charge and discharge these large batteries, and some utilities can control their customers’ air conditioners a limited number of days. The next step in our research is to best predict what day of the month to dispatch these methods (assuming the demand charge is monthly), so that utilities can be as conservative as possible.</p> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
